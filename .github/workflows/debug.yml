name: Debug Shell (Manual Only)

on:
  workflow_dispatch:

jobs:
  interactive_debug:
    runs-on: ubuntu-latest
    # ここでは一度 container を外して、ディスク掃除後に自分で起動します
    
    steps:
      # ① ディスク容量を空けるアクションを実行
      - name: Free Disk Space
        uses: jlumbroso/free-disk-space@v1.3.1
        with:
          tool-cache: true
          android: true
          dotnet: true
          haskell: true

      # ② 掃除が終わった後に Docker 経由で Zephyr 環境を立ち上げる
      - name: Run Zephyr Container and tmate
        run: |
          docker run -d --name zephyr-env -v ${{ github.workspace }}:/workdir -w /workdir zephyrprojectrtos/zephyr-build:latest sleep infinity
          
      - name: Setup tmate
        uses: mxschmitt/action-tmate@v3
        with:
          # コンテナの中で操作できるようにする
          sudo: true
